{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Resultados de compatibilidad</title>
    <link rel="stylesheet" type="text/css" href="{% static 'RoomFrom/style.css' %}">
</head>
<body>
    {% if tu_estudiante %}
    <a href="{% url 'ver_compatibles' %}" class="btn-volver">← Seleccionar otro estudiante</a>
{% endif %}

<h2>Resultados de compatibilidad</h2>

{% if tu_estudiante %}
    <p>Mostrando compatibilidad para: {{ tu_estudiante.name }}</p>

    <!-- Tabla de compatibilidad -->
    <table border="1">
        <tr>
            <th>Nombre</th>
            <th>Edad</th>
            <th>Universidad</th>
            <th>Distrito</th>
            <th>Compatibilidad</th>
            <th>Tiempo de viaje</th>
        </tr>

        {% for estudiante, score, color_class, minutos in resultados %}
        <tr>
            <td>{{ estudiante.name }}</td>
            <td>{{ estudiante.age }}</td>
            <td>{{ estudiante.university }}</td>
            <td>{{ estudiante.district }}</td>
            <td>
                <div class="bar-container">
                    <div class="fill {{ color_class }}" style="--w: {{ score|floatformat:0 }}%;">
                        {{ score|floatformat:0 }}%
                    </div>
                </div>
            </td>
            <td>{{ minutos }} min</td>
        </tr>
        {% endfor %}
    </table>

    <!-- Árbol de Conexión Mínima (MST) -->
    {% if mst %}
    <h3>Árbol de Conexión Mínima entre distritos (MST)</h3>
    <table border="1">
        <tr>
            <th>Distrito Origen</th>
            <th>Distrito Destino</th>
            <th>Distancia (km)</th>
        </tr>
        {% for u, v, peso in mst %}
        <tr>
            <td>{{ u }}</td>
            <td>{{ v }}</td>
            <td>{{ peso }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}

{% else %}
    <form method="post">
        {% csrf_token %}
        <label for="student_id">Selecciona tu perfil:</label>
        <select name="student_id">
            {% for estudiante in estudiantes %}
            <option value="{{ estudiante.student_id }}">{{ estudiante.name }}</option>
            {% endfor %}
        </select>
        <button type="submit">Buscar roomies</button>
    </form>
{% endif %}

</body>
</html>
